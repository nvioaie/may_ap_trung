const char HomePage[] PROGMEM = R"=====( 
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>TRANG CHỦ HỆ THỐNG</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #2c3e50;
      color: white;
    }
    .container {
      max-width: 500px;
      margin: 30px auto;
      background-color: #34495e;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.3);
    }
    h2 {
      text-align: center;
      margin-bottom: 20px;
    }
    .sensor-display {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
      gap: 10px;
    }
    .sensor-box {
      flex: 1;
      background-color: #2c3e50;
      border-radius: 10px;
      padding: 10px;
      text-align: center;
    }
    .sensor-value {
      font-size: 26px;
      font-weight: bold;
      margin-top: 5px;
    }
    label {
      margin-top: 15px;
      font-weight: bold;
      display: block;
    }
    input[type="number"], input[type="text"] {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border: none;
      border-radius: 5px;
      font-size: 14px;
      background-color: #2c3e50;
      color: white;
    }
    .status-row {
      display: flex;
      justify-content: space-around;
      margin: 15px 0;
      text-align: center;
    }
    .led {
      width: 25px;
      height: 25px;
      border-radius: 50%;
      background-color: #222;
      border: 2px solid white;
      margin: auto;
    }
    .led.on {
      background-color: #23C48E;
    }
    .btn-group {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 20px;
    }
    .btn-group button {
      flex: 1 1 calc(33.333% - 10px);
      padding: 12px;
      background-color: #1abc9c;
      color: white;
      font-weight: bold;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
    }
    .btn-group button:active {
      background-color: #16a085;
    }
    @media (max-width: 480px) {
      .btn-group button {
        flex: 1 1 100%;
      }
    }
    .footer {
      text-align: center;
      margin-top: 25px;
      font-size: 13px;
      color: #95a5a6;
    }
    .footer span {
      color: #2ecc71;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>TRANG CHỦ HỆ THỐNG</h2>

    <div class="sensor-display">
      <div class="sensor-box">
        Nhiệt độ
        <div id="nhietdo" class="sensor-value">-- °C</div>
      </div>
      <div class="sensor-box">
        Độ ẩm
        <div id="doam" class="sensor-value">-- %</div>
      </div>
    </div>

    <label>Ngày giờ hiện tại</label>
    <input id="datetime_now" type="text" readonly placeholder="Ngày giờ">

    <div class="status-row">
      <div>
        Đèn
        <div id="led_output1" class="led"></div>
      </div>
      <div>
        Phun sương
        <div id="led_output2" class="led"></div>
      </div>
    </div>

    <label>Giới hạn nhiệt độ (°C)</label>
    <div class="sensor-display">
      <input id="t_min" type="number" step="0.1" placeholder="Min">
      <input id="t_max" type="number" step="0.1" placeholder="Max">
      <input id="t_over" type="number" step="0.1" placeholder="Over">
    </div>

    <label>Ngưỡng cảnh báo độ ẩm (%)</label>
    <input id="h_over" type="number" step="1" placeholder="Chỉ dùng h_over">

    <div class="btn-group">
      <button onclick="window.location.href='/setup'" class="admin-only">Wi-Fi</button>
      <button onclick="saveSetup()" class="admin-only">Lưu</button>
      <button onclick="window.location.href='/edit'" class="admin-only">Quyền</button>
      <button onclick="window.location.href='/history'" style="flex: 1 1 100%;">Lịch sử dữ liệu</button>
    </div>

    <div class="footer">
      Bạn gặp khó khăn khi sử dụng?<br>
      Gọi <span>0972 935 189</span><br>
      © 2025 Hệ thống giám sát thông minh
    </div>
  </div>

  <script>
    var Socket;

    window.onload = function(){
      if(sessionStorage.getItem("LOGIN_STATE") != "1"){
        window.location.assign('home.html');
      } else {
        init();
        getSetup();
        updateClock();
        setInterval(updateClock, 1000);

        if (sessionStorage.getItem("LOGIN_ROLE") !== "admin") {
          document.querySelectorAll(".admin-only").forEach(btn => {
            btn.style.display = "none";
          });
        }
      }
    }

    function updateClock() {
      const now = new Date();
      document.getElementById("datetime_now").value = now.toLocaleString("vi-VN");
    }

    function init(){
      Socket = new WebSocket("ws://" + window.location.hostname + ":81/");
      Socket.onmessage = function(event){
        var JSONobj = JSON.parse(event.data);
        document.getElementById("nhietdo").innerText =
          JSONobj.nhietdo.includes("Lỗi") ? "Lỗi cảm biến" : JSONobj.nhietdo + " °C";
        document.getElementById("doam").innerText =
          JSONobj.doam.includes("Lỗi") ? "Lỗi cảm biến" : JSONobj.doam + " %";
        document.getElementById("led_output1").classList.toggle("on", JSONobj.output1 == "0");
        document.getElementById("led_output2").classList.toggle("on", JSONobj.output2 == "0");
      }
    }

    var xhttp = new XMLHttpRequest();

    function getSetup(){
      xhttp.onreadystatechange = function(){
        if(xhttp.readyState==4 && xhttp.status==200){
          var obj = JSON.parse(xhttp.responseText);
          document.getElementById("t_min").value = obj.nhietdo_min;
          document.getElementById("t_max").value = obj.nhietdo_max;
          document.getElementById("t_over").value = obj.nhietdo_over;
          document.getElementById("h_over").value = obj.doam_over;
        }
      }
      xhttp.open("GET","/getSetup",true);
      xhttp.send();
    }

    function saveSetup() {
      var url = "/saveSetup?t_min=" + document.getElementById("t_min").value +
                "&&t_max=" + document.getElementById("t_max").value +
                "&&t_over=" + document.getElementById("t_over").value +
                "&&h_over=" + document.getElementById("h_over").value;

      xhttp.open("GET", url, true);
      xhttp.send();
    }
  </script>
</body>
</html>
)=====";
